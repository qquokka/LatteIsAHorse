<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.like">

	<select id="getUsersLikeMenuList"
		resultType="com.latte.dto.UsersLikeMenu">
		select * from userslikemenu
	</select>

	<select id="getUsersLikeMenuCountBymenuId"
		parameterType="java.lang.Integer"
		resultType="com.latte.dto.UsersLikeMenu">
		select m.mid menu_id, count(ulm.like_count) like_count from
		menu m join
		userslikemenu ulm on m.mid=ulm.menu_id and m.mid = #{mid}
		group by
		menu_id
	</select>

	<select id="getUsersLikeMenuByCafeIdNUserId"
		parameterType="com.latte.dto.ULMCUID"
		resultType="com.latte.dto.ULMCUID">
		select m.mid menu_id, count(ulm.like_count) like_count from
		menu m join
		userslikemenu ulm on m.mid=ulm.menu_id AND m.cafe_id =
		#{cafe_id} and
		ulm.users_id =#{users_id} group by menu_id
	</select>


	<!-- DB의 모든 UserLikeCafe 리스트 반환 -->
	<select id="getUsersLikeCafeList"
		resultType="com.latte.dto.UsersLikeCafeDto">
		select id, users_id, cafe_id, like_count
		from userslikecafe
	</select>

	<!-- 카페의 좋아요 수를 반환 -->
	<select id="getUsersLikeCafeByCafeId" parameterType="java.lang.Integer"
		resultType="com.latte.dto.UsersLikeCafeDto">
		select cafe_id, count(like_count) like_count
		from userslikecafe
		where cafe_id=#{cafe_id}
	</select>

</mapper>
