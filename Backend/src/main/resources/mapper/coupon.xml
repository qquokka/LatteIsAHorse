<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mapper.coupon">

	<!-- DB 에 저장된 모든 쿠폰을 반환[관리자용] -->

	<select id="getCouponList" resultType="com.latte.dto.Coupon">
		SELECT
		id,
		users_id,
		cafe_id,
		count
		FROM coupon
	</select>

	<!-- 카페아이디로 등록된 쿠폰을 보여줍니다. -->
	<select id="getCouponListByCafeId" parameterType="_long"
		resultType="com.latte.dto.Coupon">
		SELECT id, users_id,
		cafe_id, count
		FROM coupon WHERE
		cafe_id=#{cafe_id}
	</select>

	<!-- Create -->
	<insert id="addCoupon" parameterType="com.latte.dto.Coupon">
		INSERT INTO coupon
		(users_id,
		cafe_id)
		VALUES(
		#{users_id},
		#{cafe_id}
		)
	</insert>

	<!-- Read -->
	<select id="getCouponByUserId" parameterType="_long"
		resultType="com.latte.dto.Coupon">
		select id, users_id, cafe_id, count from coupon where
		users_id =#{users_id}
	</select>

	<!-- Update -->
	<update id="updateCoupon" parameterType="com.latte.dto.Coupon">
		UPDATE coupon SET
		count =
		#{count}
		WHERE
		users_id =#{users_id}
		AND cafe_id =#{cafe_id}
	</update>
	
	<!-- Delete -->
	<delete id="deleteCouponByUserId" parameterType="_long">
		DELETE FROM
		coupon WHERE
		id=#{id}
	</delete>
</mapper>